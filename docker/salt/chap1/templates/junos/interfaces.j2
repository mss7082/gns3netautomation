{%- set interfaces = pillar.interfaces -%}



interfaces {
    {% for interface_dict in interfaces %}
    {% for intf, unit_dict in interface_dict.items() %}
    {{intf}} {
        {% for unit_number in unit_dict.units.keys() %}
        unit {{unit_number}} {
            {% if unit_dict.units[unit_number]["ipv4addr"] %}
            family inet {
                {% for ipv4 in unit_dict["units"][unit_number]["ipv4addr"] %}
                address {{ipv4}};
                {% endfor %}
            }
            {% endif %}
            {% if unit_dict.units[unit_number]["ipv6addr"] %}
            family inet {
                {% for ipv6 in unit_dict["units"][unit_number]["ipv6addr"] %}
                address {{ipv6}};
                {% endfor %}
            }
                {% endif %}
        }
        {% endfor %}
    }
    {% endfor %}
    {% endfor %}
    lo0 {
        unit 0 {
            family inet {
                address {{pillar.loopbackv4}};
            }
        }
    }
    fxp0 {
        unit 0 {
            family inet {
                address {{pillar.mgmtipv4}};
            }
        }
    }
}